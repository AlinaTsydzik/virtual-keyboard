(()=>{"use strict";const e=new class{keyboardContainer=document.createElement("div");keyCode=["IntlBackslash","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","Backspace","Tab","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","CapsLock","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","Backslash","Enter","ShiftLeft","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","ArrowUp","ShiftRight","ControlLeft","AltLeft","MetaLeft","Space","MetaRight","AltRight","ArrowLeft","ArrowDown","ArrowRight"];keyCodeSys=["Backspace","CapsLock","Enter","ShiftLeft","ShiftRight","ControlLeft","AltLeft","MetaLeft","Space","MetaRight","AltRight"];keyValueObj={en:{IntlBackslash:"`",Digit1:"1",Digit2:"2",Digit3:"3",Digit4:"4",Digit5:"5",Digit6:"6",Digit7:"7",Digit8:"8",Digit9:"9",Digit0:"0",Minus:"-",Equal:"=",Backspace:"←",Tab:"Tab",KeyQ:"q",KeyW:"w",KeyE:"e",KeyR:"r",KeyT:"t",KeyY:"y",KeyU:"u",KeyI:"i",KeyO:"o",KeyP:"p",BracketLeft:"[",BracketRight:"]",CapsLock:"CapsLock",KeyA:"a",KeyS:"s",KeyD:"d",KeyF:"f",KeyG:"g",KeyH:"h",KeyJ:"j",KeyK:"k",KeyL:"l",Semicolon:";",Quote:"'",Backslash:"\\",Enter:"↵",ShiftLeft:"Shift",KeyZ:"z",KeyX:"x",KeyC:"c",KeyV:"v",KeyB:"b",KeyN:"n",KeyM:"m",Comma:",",Period:".",Slash:"/",ArrowUp:"▲",ShiftRight:"Shift",ControlLeft:"Ctrl",AltLeft:"Alt",MetaLeft:"Cmd",Space:"",MetaRight:"Cmd",AltRight:"Alt",ArrowLeft:"◄",ArrowDown:"▼",ArrowRight:"►"},enCaps:{IntlBackslash:"`",Digit1:"1",Digit2:"2",Digit3:"3",Digit4:"4",Digit5:"5",Digit6:"6",Digit7:"7",Digit8:"8",Digit9:"9",Digit0:"0",Minus:"-",Equal:"=",Backspace:"Backspace",Tab:"Tab",KeyQ:"Q",KeyW:"W",KeyE:"E",KeyR:"R",KeyT:"T",KeyY:"Y",KeyU:"U",KeyI:"I",KeyO:"O",KeyP:"P",BracketLeft:"[",BracketRight:"]",CapsLock:"CapsLock",KeyA:"A",KeyS:"S",KeyD:"D",KeyF:"F",KeyG:"G",KeyH:"H",KeyJ:"J",KeyK:"K",KeyL:"L",Semicolon:";",Quote:"'",Backslash:"\\",Enter:"Enter",ShiftLeft:"Shift",KeyZ:"Z",KeyX:"X",KeyC:"C",KeyV:"V",KeyB:"B",KeyN:"N",KeyM:"M",Comma:",",Period:".",Slash:"/",ArrowUp:"▲",ShiftRight:"Shift",ControlLeft:"Ctrl",AltLeft:"Alt",MetaLeft:"Cmd",Space:"",MetaRight:"Cmd",AltRight:"Alt",ArrowLeft:"◄",ArrowDown:"▼",ArrowRight:"►"},enShift:{IntlBackslash:"~",Digit1:"!",Digit2:"@",Digit3:"#",Digit4:"$",Digit5:"%",Digit6:"^",Digit7:"&",Digit8:"*",Digit9:"(",Digit0:")",Minus:"_",Equal:"+",Backspace:"Backspace",Tab:"Tab",KeyQ:"Q",KeyW:"W",KeyE:"E",KeyR:"R",KeyT:"T",KeyY:"Y",KeyU:"U",KeyI:"I",KeyO:"O",KeyP:"P",BracketLeft:"{",BracketRight:"}",CapsLock:"CapsLock",KeyA:"A",KeyS:"S",KeyD:"D",KeyF:"F",KeyG:"G",KeyH:"H",KeyJ:"J",KeyK:"K",KeyL:"L",Semicolon:":",Quote:'"',Backslash:"|",Enter:"Enter",ShiftLeft:"Shift",KeyZ:"Z",KeyX:"X",KeyC:"C",KeyV:"V",KeyB:"B",KeyN:"N",KeyM:"M",Comma:"<",Period:">",Slash:"?",ArrowUp:"▲",ShiftRight:"Shift",ControlLeft:"Ctrl",AltLeft:"Alt",MetaLeft:"Cmd",Space:"",MetaRight:"Cmd",AltRight:"Alt",ArrowLeft:"◄",ArrowDown:"▼",ArrowRight:"►"},ru:{IntlBackslash:"]",Digit1:"1",Digit2:"2",Digit3:"3",Digit4:"4",Digit5:"5",Digit6:"6",Digit7:"7",Digit8:"8",Digit9:"9",Digit0:"0",Minus:"-",Equal:"=",Backspace:"Backspace",Tab:"Tab",KeyQ:"й",KeyW:"ц",KeyE:"у",KeyR:"к",KeyT:"е",KeyY:"н",KeyU:"г",KeyI:"ш",KeyO:"щ",KeyP:"з",BracketLeft:"х",BracketRight:"ъ",CapsLock:"CapsLock",KeyA:"ф",KeyS:"ы",KeyD:"в",KeyF:"а",KeyG:"п",KeyH:"р",KeyJ:"о",KeyK:"л",KeyL:"д",Semicolon:"ж",Quote:"э",Backslash:"ё",Enter:"Enter",ShiftLeft:"Shift",KeyZ:"я",KeyX:"ч",KeyC:"с",KeyV:"м",KeyB:"и",KeyN:"т",KeyM:"ь",Comma:"б",Period:"ю",Slash:"/",ArrowUp:"▲",ShiftRight:"Shift",ControlLeft:"Ctrl",AltLeft:"Alt",MetaLeft:"Cmd",Space:"",MetaRight:"Cmd",AltRight:"Alt",ArrowLeft:"◄",ArrowDown:"▼",ArrowRight:"►"},ruCaps:{IntlBackslash:"]",Digit1:"1",Digit2:"2",Digit3:"3",Digit4:"4",Digit5:"5",Digit6:"6",Digit7:"7",Digit8:"8",Digit9:"9",Digit0:"0",Minus:"-",Equal:"=",Backspace:"Backspace",Tab:"Tab",KeyQ:"Й",KeyW:"Ц",KeyE:"У",KeyR:"К",KeyT:"Е",KeyY:"Н",KeyU:"Г",KeyI:"Ш",KeyO:"Щ",KeyP:"З",BracketLeft:"Х",BracketRight:"Ъ",CapsLock:"CapsLock",KeyA:"Ф",KeyS:"Ы",KeyD:"В",KeyF:"А",KeyG:"П",KeyH:"Р",KeyJ:"О",KeyK:"Л",KeyL:"Д",Semicolon:"Ж",Quote:"Э",Backslash:"Ё",Enter:"Enter",ShiftLeft:"Shift",KeyZ:"Я",KeyX:"Ч",KeyC:"С",KeyV:"М",KeyB:"И",KeyN:"Т",KeyM:"Ь",Comma:"Б",Period:"Ю",Slash:"/",ArrowUp:"▲",ShiftRight:"Shift",ControlLeft:"Ctrl",AltLeft:"Alt",MetaLeft:"Cmd",Space:"",MetaRight:"Cmd",AltRight:"Alt",ArrowLeft:"◄",ArrowDown:"▼",ArrowRight:"►"},ruShift:{IntlBackslash:"[",Digit1:"!",Digit2:'"',Digit3:"№",Digit4:"%",Digit5:":",Digit6:",",Digit7:".",Digit8:"*",Digit9:"(",Digit0:")",Minus:"_",Equal:"+",Backspace:"Backspace",Tab:"Tab",KeyQ:"Й",KeyW:"Ц",KeyE:"У",KeyR:"К",KeyT:"Е",KeyY:"Н",KeyU:"Г",KeyI:"Ш",KeyO:"Щ",KeyP:"З",BracketLeft:"Х",BracketRight:"Ъ",CapsLock:"CapsLock",KeyA:"Ф",KeyS:"Ы",KeyD:"В",KeyF:"А",KeyG:"П",KeyH:"Р",KeyJ:"О",KeyK:"Л",KeyL:"Д",Semicolon:"Ж",Quote:"Э",Backslash:"Ё",Enter:"Enter",ShiftLeft:"Shift",KeyZ:"Я",KeyX:"Ч",KeyC:"С",KeyV:"М",KeyB:"И",KeyN:"Т",KeyM:"Ь",Comma:"Б",Period:"Ю",Slash:"?",ArrowUp:"▲",ShiftRight:"Shift",ControlLeft:"Ctrl",AltLeft:"Alt",MetaLeft:"Cmd",Space:"",MetaRight:"Cmd",AltRight:"Alt",ArrowLeft:"◄",ArrowDown:"▼",ArrowRight:"►"}};createKeyboardLayout(e){document.querySelectorAll(".btn").forEach((t=>{t.classList.contains("btn-id27")?t.innerHTML=`<span class="btn-led"></span>${this.keyValueObj[e][t.dataset.key]}`:t.textContent=this.keyValueObj[e][t.dataset.key]}))}createKeyboardBtns(e="en"){for(let e=0;e<this.keyCode.length;e+=1)this.keyboardContainer.insertAdjacentHTML("beforeend",`\n          <button id="${this.keyCode[e]}" class="btn  btn-id${e}" data-key="${this.keyCode[e]}"></button>`);this.createKeyboardLayout(e)}},t=document.createElement("div");t.className="main-wrapper",document.body.append(t),t.insertAdjacentHTML("afterbegin",'\n<textarea inputmode="text" class="textarea"></textarea>');const i=document.querySelector(".textarea");e.keyboardContainer.className="keyboard-container",t.append(e.keyboardContainer),t.insertAdjacentHTML("beforeend",'\n    <div class="description"><p>Виртуальная клавиатура разработана в Mac OS.</p> \n    <p>Для переключения языка используется сочетание клавиш <b>Alt + Ctrl</b>.</p>\n    <p>&nbsp;</p>\n    <p class="ps">P.S. в Mac Os одновременное нажатие Shift и CapsLock приводит к вводу прописных (заглавных) букв и специальных символов в верхнем ряду клавиш. В данной клавиатуре был реализован именно этот сценарий, т.к. четких требований задания на этот счет не было. </p>\n    </div>\n    ');let a=localStorage.getItem("mode");a||(a="en");let n=!1;function o(){const t=document.querySelector(".btn-id27");"en"===a?(a="enCaps",t.classList.add("active"),n=!0):"ru"===a?(a="ruCaps",t.classList.add("active"),n=!0):"enCaps"===a?(a="en",t.classList.remove("active"),n=!1):"ruCaps"===a&&(a="ru",t.classList.remove("active"),n=!1),e.createKeyboardLayout(a)}function s(){a="en"===a||"enCaps"===a?"enShift":"ruShift",e.createKeyboardLayout(a)}function y(){"enShift"===a&&!1===n?a="en":"ruShift"===a&&!1===n?a="ru":"enShift"===a&&!0===n?a="enCaps":"ruShift"===a&&!0===n&&(a="ruCaps"),e.createKeyboardLayout(a)}e.createKeyboardBtns(a),document.addEventListener("keydown",(t=>{t.altKey&&t.ctrlKey&&("en"===a?(a="ru",localStorage.setItem("mode","ru")):"ru"===a?(a="en",localStorage.setItem("mode","en")):"enCaps"===a?(a="ruCaps",localStorage.setItem("mode","ru")):"ruCaps"===a&&(a="enCaps",localStorage.setItem("mode","en")),e.createKeyboardLayout(a))})),document.addEventListener("keyup",(e=>{"CapsLock"===e.code&&o()}));const c=document.querySelectorAll(".btn-id41, .btn-id53");function r(){i.focus()}c.forEach((e=>e.addEventListener("mousedown",s))),c.forEach((e=>e.addEventListener("mouseup",y))),document.addEventListener("keydown",(e=>{"ShiftLeft"!==e.code&&"ShiftRight"!==e.code||s()})),document.addEventListener("keyup",(e=>{"ShiftLeft"!==e.code&&"ShiftRight"!==e.code||y()})),document.addEventListener("keydown",(function(t){if("CapsLock"!==t.code)for(let i=0;i<e.keyCode.length;i+=1){const a=document.getElementById(`${e.keyCode[i]}`);t.code===a.id&&a.classList.add("active")}})),document.addEventListener("keyup",(function(t){if("CapsLock"!==t.code)for(let i=0;i<e.keyCode.length;i+=1){const a=document.getElementById(`${e.keyCode[i]}`);t.code===a.id&&a.classList.remove("active")}})),r(),document.addEventListener("click",r),document.addEventListener("keydown",r),document.addEventListener("click",(function(e){if(!e.target.classList.contains("btn"))return;let t=e.target.textContent;if(e.target.classList.contains("btn-id13")){t="";const e=i.selectionStart;i.value=i.value.slice(0,e-1)+i.value.slice(e),i.setSelectionRange(e-1,e-1)}if(e.target.classList.contains("btn-id14")&&(t="    "),e.target.classList.contains("btn-id27")&&(t="",o()),e.target.classList.contains("btn-id40")){t="";const e=i.selectionStart,a=i.selectionEnd,n=`${i.value.slice(0,e)}\n`;i.value=`${i.value.slice(0,e)}\n${i.value.slice(a,i.value.length)}`,i.focus(),i.setSelectionRange(n.length,n.length)}e.target.classList.contains("btn-id57")&&(t=" "),(e.target.classList.contains("btn-id41")||e.target.classList.contains("btn-id53")||e.target.classList.contains("btn-id54")||e.target.classList.contains("btn-id55")||e.target.classList.contains("btn-id56")||e.target.classList.contains("btn-id58")||e.target.classList.contains("btn-id59")||e.target.classList.contains("btn-id63"))&&(t=""),i.value+=`${t}`})),document.onkeydown=t=>{for(let i=0;i<e.keyCodeSys.length;i+=1)if(t.code===`${e.keyCodeSys[i]}`)return!0;return!1};let K="";document.addEventListener("keydown",(function(t){for(let i=0;i<e.keyCodeSys.length;i+=1)if(K=document.getElementById(`${e.keyCodeSys[i]}`),t.code===K.id)return;if("Tab"!==t.code)if("AltLeft"!==t.code&&"AltRight"!==t.code)for(let a=0;a<e.keyCode.length;a+=1)K=document.getElementById(`${e.keyCode[a]}`),t.code===K.id&&(i.value+=K.textContent);else i.value+="";else i.value+="    "}))})();